<!-- notification.component.html -->
<div class="notification-container">
  <!-- Notification Bell Button -->
  <button 
    class="notification-btn" 
    (click)="toggleNotifications()"
    [attr.aria-label]="'Notifications. ' + unseenCount + ' unread'"
  >
    <svg class="bell-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
      <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
    </svg>
    
    <!-- Unread Badge -->
    <span class="notification-badge" *ngIf="unseenCount > 0">
      {{ unseenCount > 9 ? '9+' : unseenCount }}
    </span>
  </button>

  <!-- Notification Panel -->
  <div class="notification-panel" *ngIf="isOpen">
    <!-- Header -->
    <div class="notification-header">
      <h2 class="header-title">Notifications</h2>
      <button 
        class="close-btn" 
        (click)="closeNotifications()"
        aria-label="Close notifications"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <!-- Action Bar -->
    <div class="action-bar" *ngIf="unseenCount > 0">
      <button class="mark-btn" (click)="markAllAsSeen()">Mark all as read</button>
    </div>

    <!-- Notifications List -->
    <div class="notifications-scroll" (scroll)="Notifinfinitescroll($event)">
      <div 
        *ngIf="notifications().length === 0" 
        class="empty-state"
      >
        <svg class="empty-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
        <p>No notifications yet</p>
      </div>

      <div 
        *ngFor="let notification of notifications()"
        class="notification-item"
        [class.unseen]="!notification.seen()"
        (click)="ToggleSeen(notification)"
      >
        <img 
          class="sender-avatar" 
          [src]="getAvatarUrl(notification.sender.avatar)" 
          [alt]="notification.sender.username"
        />
        <div class="notification-content">
          <div class="sender-info">
            <span class="sender-name">{{ notification.sender.username }}</span>
            <span class="time-badge">{{ formatTime(notification.createdAt) }}</span>
          </div>
          <p class="notification-text">{{ notification.content }}</p>
        </div>

        <button 
          class="delete-btn" 
          (click)="deleteNotification(notification); $event.stopPropagation()"
          aria-label="Delete notification"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            <line x1="10" y1="11" x2="10" y2="17"></line>
            <line x1="14" y1="11" x2="14" y2="17"></line>
          </svg>
        </button>
      </div>
    </div>

    <!-- Footer -->
    <div class="notification-footer" *ngIf="notifications.length > 0">
      <button class="clear-btn" (click)="clearAll()">Clear all</button>
    </div>
  </div>
</div>

<!-- Optional: Backdrop to close on outside click -->
<div 
  class="notification-backdrop" 
  *ngIf="isOpen"
  (click)="closeNotifications()"
></div>